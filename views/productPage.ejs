<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>
        <%= produto.nome %> | Tênis Zone
    </title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
    <link rel='stylesheet' type='text/css' media='screen' href='/stylesheets/navBar.css'>
    <link rel='stylesheet' type='text/css' media='screen' href='/stylesheets/productPage.css'>
    <link rel='stylesheet' type='text/css' media='screen' href='/stylesheets/bootstrap.min.css'>
    <script src='/javascripts/sideBar.js' defer></script>
    <script src='/javascripts/slider-images.js' defer></script>
    <script src='/javascripts/selectSize.js' defer></script>
    <script src='/javascripts/bootstrap.bundle.min.js' defer></script>
</head>

<body>
    <nav id="nav-container">
            <header id="header"><a class="open-btn" onclick="toggleSidebar()">Tênis Zone</a></header>
            <ul class="nav-links">
                <% if (!cliente) { %>
                <li><a href="/login"><i class="bi bi-person-circle"></i></a></li>
                <% } else { %>
                <li><a href="/carrinho/"><i class="bi bi-cart2"></i></a></li>
                <li><a href="/minhaConta/<%= cliente.clienteID %>"><i class="bi bi-person-circle"></i></a></li>
                <% } %>
            </ul>
        </nav>

   <div class="sidebar" id="sidebar">
            <a href="/home" class="home-button"><i class="bi bi-house"></i></a>
            <button class="close-btn" onclick="toggleSidebar()">x</button>

            <ul class="sidebar-links">
                <% if(!cliente){ %>
                <li><a href="#">Masculino</a></li>
                <li><a href="#">Feminino</a></li>
                <% } else { %>
                <li><a href="#">Masculino</a></li>
                <li><a href="#">Feminino</a></li>
                <li><a href="/minhasCompras">Minhas compras</a></li>
                <% } %>
            </ul>

            <% if (cliente) { %>
                <div class="container-links">
                <li><a href="/logout" class="logout-button"><i class="bi bi-box-arrow-right"></i></a></li>
                </div>
            <% } %>
        </div>

    <main id="content-container">
        <article class="image-container">
            <div class="slider-container">
                <div class="slider">
                    <% if (produto.imagens && produto.imagens.length > 0) {
                        const imagensArray = produto.imagens.split(',');
                    %>
                        <% imagensArray.forEach(imagem => { %>
                            <img src="/images/<%= produto.pasta_imagens %>/<%= imagem.trim() %>" alt="<%= produto.nome %>">
                        <% }) %>
                    <% } else { %>
                        <img src="/images/sem-imagem-disponivel.jpg" alt="Imagem indisponível">
                    <% } %>
                </div>
                <button class="prev">❮</button>
                <button class="next">❯</button>
            </div>
        </article>

        <aside>
            <div class="product-info">
                <p class="title"><%= produto.nome %></p><br>
                <p class="old-price">R$<%= Number(produto.preco_original).toFixed(2).replace(".",",") %></p>
                <p class="info"><strong>R$ <%= Number(produto.preco_pix).toFixed(2).replace(".", ",") %> no Pix</strong></p>
                <p class="info">ou <strong>R$ <%= Number(produto.preco_parcelado).toFixed(2).replace(".",",") %></strong> em até <strong>12x sem juros</strong></p><br>
                <p class="info"><strong>Cor:</strong> <%= produto.cor %></p><br>
                <p class="info"><strong>Quantidade no estoque:</strong> <%= estoque.quantidade %></p><br>

                <% const tamanhosArray = produto.tamanhos.split(','); %>

                <form id="formAdicionarCarrinho" method="POST" action="/carrinho/adicionar/<%= produto.produtoID %>">
                    <div class="tamanhos">
                        <p class="info"><strong>Tamanhos disponíveis:</strong></p>
                        <% tamanhosArray.forEach(tamanho => { %>
                            <button class="product-size" type="button" data-size="<%= tamanho.trim() %>">
                                <%= tamanho.trim() %>
                            </button>
                        <% }) %>
                    </div>

                    <input type="hidden" name="tamanho" id="inputTamanhoSelecionado">
                    <button type="submit" class="buy-button">Comprar</button>
                </form>
            </div>
        </aside>
    </main>

    <!-- Pop-up de aviso -->
<div id="popup-alert" class="popup-alert">Por favor, selecione um tamanho antes de comprar.</div>

</body>
</html>
